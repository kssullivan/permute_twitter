<html>
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="jquery.canvasScramble.js"></script>
    <style type="text/css"></style>
    <link href='https://fonts.googleapis.com/css?family=Lekton' rel='stylesheet' type='text/css'>
    <script type="text/javascript">

      $(document).ready(function(){
//FUNCTION C
//Takes alert input feild, and populates empty array (result)
        function all_permutations(input) {
            var result = [];
            function permute(elements, data) {
                var current, memo = data || [];
                for (var i = 0; i < elements.length; i++) {
                    current = elements.splice(i, 1)[0];
                    if (elements.length === 0) {
                        result.push(memo.concat([current]));
                    }
                    //runs native javascript permutation algorithm on the input (result) values
                    permute(elements.slice(), memo.concat([current]));
                    elements.splice(i, 0, current);
                }
                return result;
            }
            return permute(input);
        }

//FUNCTION B
        //function pulls object from prompt field "search"
        function display_permutations(search) {

          //creates array objects of individual words by "splitting" at each " "(space)

            var wordsArray = search.split(" ").slice(2,6);
            var text = '', permutations, i, j;
            console.log(wordsArray);

          //declares js vars from html elements "main:main", creates "last:div"
            var main = document.getElementById('main'), last = document.createElement('div');
            permutations = all_permutations(wordsArray);

          //creates array that gets succesively populated with each permutation generated by function
            var fullPermutationsArray = [];
            for (i in permutations) {
                for (j in permutations[i]) {
                    text = text + permutations[i][j] + ' ';
                }
                var fullPermutation = "";
                for(k in permutations[i]) {
                  fullPermutation += permutations[i][k] + " ";
                }
                var fullPermutationWithQuots = '"'+fullPermutation+'"';
                fullPermutationsArray.push(fullPermutationWithQuots);
                text = text + '<br />';
            }
            //excerpts 10 twitter results, removes up to 1000
            fullPermutationsArray = fullPermutationsArray.slice(1,10);
            fullPermutationsArray.splice(10,1000);
            console.log(fullPermutationsArray);

            //makes call to twitter api, with each permutation
            var query = fullPermutationsArray.join(" OR ");
            var url = "http://cooper-union-search-proxy.herokuapp.com/twitter/search/" + query;
            console.log(url);

            //pulls twitter JSON objects
            $.getJSON(url,
              function(response){
                console.log(response);
                console.log(response.statuses);

                var tweet = response.statuses[0].text;
                var tweetString = JSON.stringify(tweet);

                //pulls profile pic from object, converts to string, removes "normal" clause
                var profPic = response.statuses[0].user.profile_image_url;
                var profString = JSON.stringify(profPic).replace("_normal",'');

                //
                // document.getElementById('image').setAttribute('src',profString)

                // document.createElement('image').setAttribute('src', profString)
                var image = document.getElementById('image').setAttribute('src', profString)
                $('#image').addClass('imageAppear');

                // var DisplayImg = $('image').canvasScramble({debug:true,displayInput:false});

                console.log(tweetString);
                console.log(profString);
                $('#main').addClass('mainAppear');
                // $(".start").html(query);

                var search = [];
                var newSearch = tweetString.split(" ").slice(2,6);
                //search.push(newSearch);
              //  console.log(search);

                display_permutations(tweetString);

                // for (var i = 0; i < newSearch.length; i++) {
                //   newSearchArray.push(newSearch);
                // }



              });

            //pushes text objects to html element "last"
            last.innerHTML = text;
            main.appendChild(last);







        }

//FUNCTION A
      //calls prompt on the click of html elm "start",
       $('.start').click(function(){
          var search = prompt("Type a phrase below, using at least six common words.");
          $('h2').toggleClass("invisible");
          console.log(search);
          display_permutations(search);
        });//end of the click function

    });



    </script>


    <style>

  .start{
display: block;
position: relative;
left: 30%;
top: 30%;
/*z-index: -1;*/
border-style: outset;
width: 100px;
height: 45px;
border-radius: 16px;
text-decoration: none;
color: darkgray;
font-family: 'Roboto', sans-serif;
font-weight: lighter;
font-size: 1.2em;
font-kerning: 2px;
padding-top: 15px;
background-color: rgba(192,192,192,0.3);
text-align: center;
/*background-color: rgb(246,246,246);*/
/*transition: background-color 1s ease;
  background-color: rgba(192,192,192,0.3);*/
/*color:rgba(192,192,192,0.3);
transition: color 0.5s ease;*/
}

.start {
    opacity: 0.4;
    filter: alpha(opacity=40);
}

.start:hover {
    opacity: 1.0;
    filter: alpha(opacity=100);
}

  .invisible{
    visibility: hidden;
  }

  #main{
display: block;
font-family: 'Lekton';
font-weight: lighter;
font-size: 1em;
color: rgb (40,40,40);
width: 500px;
height: auto;
position: relative;
left: 10%;
top: 3%;
padding: 50px;
  }

  div {
    padding: 50px;
    display: block;
    padding-bottom: 100px;
    width: inherit;
    height:inherit;
  }

/*#pic {
  background-image: image();
  width: 30px;
  height: auto;
  display: inline-block;

}*/

  /*#image {
  width: 30px;
  height: auto;
  display: block;
}*/

    </style>
  </head>

<body>


<h2 class="start"> _ ? _ _ </h2>

<br>

<div id="main">
</div>

<img id="image"/>




</body></html>
